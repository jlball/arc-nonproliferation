# arc-nonproliferation
An OpenMC-based repo for studying proliferation issues in ARC-class fusion reactors.

## Installation and Setup
This repo requires OpenMC and its depenencies. I recommend installing from source and using the latest developent build. I am fairly confident that all of the OpenMC dependencies cover the required python packages needed for the rest of the code. To learn how to install OpenMC from source, visit the official website [openmc.org](https://www.openmc.org).

The repo is built around a custom python package. After installing OpenMC from source, navigate to the repo directory and run:

`pip install -e .`

to install the custom API localy.

## File Structure and Organization

This repository is built around a custom python api called `arc_nonproliferation` which includes classes, functions, and data which is helpful in conducting analyses of ARC-class reactors. This API was adpoted from one originally developed by Ethan Peterson for the Fall 2022 edition of MIT's course 22.63 Engineering Principles for Fusion Reactors, taught by Dennis Whyte.

### arc_nonproliferation

#### device.py
The device class inherits from the OpenMC model class, and is designed to allow for the rapid parametric generation of ARC OpenMC models with FLiBe doped with a specified amount of fertile material. This is achieved using the `generate_device()` function. This allows for many models with varying fertile inventories, dopant types, and lithium enrichments to be generated and simulated in a single script.

#### constants.py

Containts useful constant values which can be easily accessed across scripts. Includes things like neutrons / MJ, and the path to the OpenMC chain file to use.

#### materials.py

This file contains definitions for all of the materials used in the OpenMC simulations, along with functions for generating FLiBe materials doped with specific masses of Thorium or Uranium.

#### postprocess.py

This file contains useful helper functions which can be applied across simulation type to extract useful information from OpenMC statepoint and depletion results files. This includes functions for computing the time to breed a significant quantity and compute the isotopic purity of fissile material.

### data

This directory contains supporting data files, like outputs from stochastic volume calculations, lists of points which specify vacuum vessel and blanket geometries, and OpenMC chain files.

### openmc_scripts
The openmc_scripts directory contains all scripts which run OpenMC simulations and analyze the resulting data. The different types of simulations are each in separate directories. They are described below:

| Directory   | Description |
| ----------- | ----------- |
| scan        | scans over fertile inventory with simple transport calculations, no depletion or time effects are resolved.  |
| depletion_scan   | scans over fertile inventory with coupled depletion calculations, evaluating at least one transport calculation at each timestep.         |
| independent_depletion  | scans over fertile inventory with independent depletion calculations  |
| geometry_plots | scripts for using OpenMC's built in geometry plotting tools to visualize model geometry |
| depletion | runs a single coupled depletion calculation for a single `device` instance. |

Each directory contains a script which runs a calculation and generates an output directory structure. These scripts take as an argument when run from the command line the name of the directory in which to store the output. There is an accompianing "post-processing" script which has the same name as the script which ran the simulation, but with "pp-" placed before the name. To run the post processing script, pass in the name of the directory you wish to analyse as a command line argument. The figures generated by the post processing script will be stored in a directory called "figures" inside of the main directory for the run.

By default, all output directories are placed in the same directory as the scripts. Some of the scripts, like `independent-depletion-arc-1.py` and `depletion-scan-arc-1.py` take a second command line argument, the enrichment of Li-6 in percent.

## Accompianing Manuscript

Results generated with this repo were used to prepare the manuscript "Assesing the risk of proliferation via fissile breeding in ARC-class fusion reactors" a preprint of which can be found on the arXiv at the following link: [https://arxiv.org/abs/2404.12451](https://arxiv.org/abs/2404.12451).

### Natural Li-6 enrichment

Sections 4.1 to 4.6 present time to a significant quantity, fission power, TBR, isotopic purity, self-protection time, and decay heat for a FliBe blanket with a natural Li-6 enrichment for fertile inventories of 5 to 50 metric tons. The data used to generate these results is stored in the `pub_data_Li6_7.5` directory inside of `openmc_scripts/depletion_scan`. Time to a significant quantity, fission power, TBR, istopic purity, and decay heat are all computed using the script `pp-depletion-scan-arc-1.py`. 

Self-protection time is more complex, as an additional decay-only calculation must be run in order to determine when the dose rate drops below the self-protetion threshold. Thus the script `decay_calc.py` must be run first on `pub_data_Li6_7.5`, and then the script `calculate_dose_rate_decay.py` which computes the dose rate at each timepoint using an additional Monte-Carlo calculation in a simple infinite slab geometry. This model is specified in the file `dose_rate_model.py`. 

You can find the figures generated by these scripts in the directory `pub_data_Li6_7.5/figures`.

### Li-6 enrichment scan

Section 4.7 presents the same results as above but with the addition of a second independent varaible, Li-6 enrichment. The data presented in this section is stored in seven directories called `pub_data_Li6_enrichment` where enrichment is the Li-6 enrichment of the blanket for each mass studied.

The same three scripts mentioned above must now be run for each directory in turn. There is a simpe bash script called `pub_post_process.sh` which allows for all of this analysis to be run at once. The scripts above store their output in python pickle files which can be found in the `data` subdirectory inside of each `pub_data_Li6` directory. The inidividual subplots which make up figures 9 and 10 and figures 11 and 12 are generated by the script `Li6_plots.py` which relies on these pickle files being present and complete. The figures generated by this script are stored in the output directory `pub_figures`.

### 2D Plots

Fig. 14 plots a subsection of the quantities discussed above on a 2D plot of Li-6 enrichment vs. fertile mass inventory. These plots are generated by the script `proliferation_plot.py` and also relies on the data pickles generated by the scripts discussed above.

### Uranium impurities in beryllium

Section 4.10 discusses the production of fissile material from uranium impurities in the berylliu used to make FLiBe. These results are generated from an independent depletion calculation, stored in the `pub_run_impure` directory. The script `wppm-independent-depletion-arc-1.py` specifies this calculation, and allows for the quantity of fertile material in the blanket fluid to be specified as a weight fraction of beryllium in units of weight parts per million. Figure 15 is generated by the script `pp-wppm-independent-depletion-arc-1.py`.







